<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.javasm.crm.b2c.mapper.OrderMapper">
  <resultMap id="BaseResultMap" type="com.javasm.crm.b2c.entity.Order">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="orderId" jdbcType="INTEGER" property="orderid" />
    <result column="orderType" jdbcType="VARCHAR" property="ordertype" />
    <result column="orderAction" jdbcType="VARCHAR" property="orderaction" />
    <result column="businessType" jdbcType="VARCHAR" property="businesstype" />
    <result column="payMode" jdbcType="VARCHAR" property="paymode" />
    <result column="orderDate" jdbcType="VARCHAR" property="orderdate" />
    <result column="orderState" jdbcType="VARCHAR" property="orderstate" />
    <result column="memberAccount" jdbcType="INTEGER" property="memberaccount" />
    <result column="productId" jdbcType="INTEGER" property="productid" />
    <result column="commodityList" jdbcType="INTEGER" property="commoditylist" />
     <result column="distributionWay" jdbcType="VARCHAR" property="distributionway" />
      <association column="consigneeid" property="oconsignee" javaType="com.javasm.crm.b2c.entity.Consignee" select="com.javasm.crm.b2c.mapper.ConsigneeMapper.selectConsigneeByid">
     </association> 
     <collection column="orderId" property="orderinfo" ofType="com.javasm.crm.b2c.entity.Orderinformation" select="com.javasm.crm.b2c.mapper.OrderOdinfoMapper.selectOrderinfoByid2"></collection>
  </resultMap>
  
  <!--公共sql语句块  -->
  <sql id="Base_Column_List">
    id,
    orderId, 
    orderType, 
    orderAction, 
    businessType, 
    payMode, 
    orderDate, 
    orderState, 
    memberAccount, 
    productId, 
    commodityList,
    distributionWay
  </sql>
  
  
 	<select id="selectOrderAndUserByOid" resultMap="BaseResultMap" parameterType="com.javasm.crm.b2c.entity.Order">
		SELECT
			`order`.orderId,
			`order`.orderType,
			`order`.orderAction,
			`order`.businessType,
			`order`.payMode,
			`order`.orderDate,
			`order`.orderState,
			`order`.memberAccount,
			`order`.productId,
			`order`.commodityList,
			`order`.distributionWay,
			`order`.consigneeid
			FROM
			`order`
			WHERE
			`order`.orderId = #{orderid}
			AND
			`order`.consigneeid IS not NULL
	</select>
  
   <!-- 查询所有以及分页查询 --> 
  <select id="selectAll" parameterType="com.javasm.crm.b2c.entity.Order" resultType="com.javasm.crm.b2c.entity.Order">
    select  *  from `order` 
      <!-- 以下为查询条件 -->
     <where>
      <if test="orderid !=null and orderid!='' " >
       and orderId like #{orderid}  
      </if>
       <if test="ordertype !=null and ordertype!=''">
       and orderType like  #{ordertype}
      </if>
      <if test="paymode !=null and paymode!=''">
       and payMode like #{paymode}
      </if>
     <if test="businesstype !=null and businesstype!=''">
       and businessType like #{businesstype}
      </if>
      <if test="orderaction !=null and orderaction!='' ">
       and orderAction like #{orderaction}
      </if>
       <if test="orderstate !=null and orderstate!=''">
       and orderState like #{orderstate}
      </if> 
       
      <if test="startTime !=null and startTime != '' ">
       and orderDate &gt;= #{startTime}
      </if>
       <if test="endTime != null and endTime !=''">
        and orderDate &lt;= #{endTime}
      </if> 
      <if test="commoditylist !=null and commoditylist !='' ">
       and `commodityList`  like CONCAT(CONCAT('%',#{commoditylist}),'%')
      </if>
     </where>
  </select>
  
  
  
  <!-- 批量插入数据  注意点：表名和关键字是否冲突-->
  <insert id="insertOrder" parameterType="java.util.List" useGeneratedKeys="false" > 
    insert into  `order`
    values
     <foreach collection="list" item="item" separator="," >
     (
     null,
     #{item.orderid},
     #{item.ordertype},
     #{item.orderaction},
     #{item.businesstype},
     #{item.paymode},
     #{item.orderdate},
     #{item.orderstate},
     #{item.memberaccount},
     #{item.productid},
     #{item.commoditylist},
     #{item.distributionway}
     )
     </foreach>
   </insert> 
   
   <!-- 查询订单类型 -->
   <select id="selectOrderType" resultType="String">
    select  distinct  OrderType from `order`
   </select>
   
   <!-- 查询支付方式 -->
   <select id="selectPayMode" resultType="String">
    select distinct  payMode from `order`
   </select>
   
    <!-- 查询业务类型 -->
   <select id="selectBusinessType" resultType="String">
   select  distinct  businessType from `order`
   </select>
   
    <!-- 查询订单动作-->
   <select id="selectOrderAction" resultType="String">
   select  distinct  orderAction from `order`
   </select>
   
    <!-- 查询订单状态 -->
   <select id="selectOrderState" resultType="String">
   select  distinct  orderState from `order`
   </select>
   
   <!-- 查询所有数据的 -->
   <select id="Derive" resultType="com.javasm.crm.b2c.entity.Order">
    select * from `order`
   </select>
 
 
</mapper>